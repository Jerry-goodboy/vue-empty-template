// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.7/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../Color","../GeometryUtils"],function(m,n,h,l){return function(){function c(a,b,d){this.isDataDriven=!1;switch(b.type){case "number":a=!0;break;case "color":a=!0;d=c._parseColor(d);break;case "array":a="number"===b.value;break;default:a=!1}null==d&&(d=b.default);a&&"interval"===d.type&&(a=!1);var g=d&&d.stops&&0<d.stops.length;if(this.isDataDriven=d&&!!d.property)if(g)switch(d.type){case "identity":this.getValue=this._buildIdentity(d,b);break;case "categorical":this.getValue=
this._buildCategorical(d,b);break;default:this.getValue=a?this._buildInterpolate(d,b):this._buildInterval(d,b)}else this.getValue=this._buildIdentity(d,b);else this.getValue=g?a?this._buildZoomInterpolate(d):this._buildZoomInterval(d):this._buildSimple(d)}c.prototype._buildSimple=function(a){return function(){return a}};c.prototype._buildIdentity=function(a,b){return function(d,g){var e;g&&(e=g.values[a.property],"color"===b.type&&(e=c._parseColor(e)));return void 0!==e?e:void 0!==a.default?a.default:
b.default}};c.prototype._buildCategorical=function(a,b){var d=this;return function(g,e){var c;e&&(c=e.values[a.property]);c=d._categorical(c,a.stops);return void 0!==c?c:void 0!==a.default?a.default:b.default}};c.prototype._buildInterval=function(a,b){var d=this;return function(g,e){var c;e&&(c=e.values[a.property]);return"number"===typeof c?d._interval(c,a.stops):void 0!==a.default?a.default:b.default}};c.prototype._buildInterpolate=function(a,b){var d=this;return function(g,e){var c;e&&(c=e.values[a.property]);
return"number"===typeof c?d._interpolate(c,a.stops,a.base||1):void 0!==a.default?a.default:b.default}};c.prototype._buildZoomInterpolate=function(a){var b=this;return function(d){return b._interpolate(d,a.stops,a.base||1)}};c.prototype._buildZoomInterval=function(a){var b=this;return function(d){return b._interval(d,a.stops)}};c.prototype._categorical=function(a,b){for(var d=b.length,c=0;c<d;c++)if(b[c][0]===a)return b[c][1]};c.prototype._interval=function(a,b){for(var d=b.length,c=0,e=0;e<d;e++)if(b[e][0]<=
a)c=e;else break;return b[c][1]};c.prototype._interpolate=function(a,c,d){for(var b,e,h=c.length,f=0;f<h;f++){var k=c[f];if(k[0]<=a)b=k;else{e=k;break}}if(b&&e){f=e[0]-b[0];a-=b[0];d=1===d?a/f:(Math.pow(d,a)-1)/(Math.pow(d,f)-1);if(Array.isArray(b[1])){b=b[1];e=e[1];a=[];for(f=0;f<b.length;f++)a.push(l.interpolate(b[f],e[f],d));return a}return l.interpolate(b[1],e[1],d)}if(b)return b[1];if(e)return e[1]};c._isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};c._parseColor=
function(a){if(Array.isArray(a))return a;if("string"===typeof a){if(a=new h(a),!this._isEmpty(a))return h.toUnitRGBA(a)}else return a&&a.default&&(a.default=c._parseColor(a.default)),a&&a.stops&&(a.stops=a.stops.map(function(a){return[a[0],c._parseColor(a[1])]})),a};return c}()});