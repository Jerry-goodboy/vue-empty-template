// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.7/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/accessorSupport/decorators ../../Widget ../../Legend/support/styleUtils ../../support/widget".split(" "),function(x,y,t,q,u,v,m,w,p,f){return function(r){function k(a){a=r.call(this)||this;a.activeLayerInfos=null;return a}t(k,r);k.prototype.render=function(){var a=this,d=this.activeLayerInfos,b=f.join("esri-legend esri-widget--panel",
"esri-widget"),d=d&&d.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});return f.tsx("div",{class:b},d&&d.length?d:f.tsx("div",{class:"esri-legend__message"},u.noLegend))};k.prototype._renderLegendForLayer=function(a){var d=this;if(!a.ready)return null;var b=!!a.children.length,h="esri-legend__"+a.layer.uid+"-version-"+a.version,c=a.title?f.tsx("div",{class:"esri-legend__service-label"},a.title):null;if(b){var e=a.children.map(function(a){return d._renderLegendForLayer(a)}).toArray(),
b=(g={},g["esri-legend__group-layer"]=b,g);return f.tsx("div",{key:h,class:"esri-legend__service",classes:b},c,e)}if((b=a.legendElements)&&!b.length)return null;g=b.map(function(b){return d._renderLegendForElement(b,a.layer)}).filter(function(a){return!!a});if(!g.length)return null;b=(e={},e["esri-legend__group-layer-child"]=!!a.parent,e);return f.tsx("div",{key:h,class:"esri-legend__service",classes:b},c,f.tsx("div",{class:"esri-legend__layer"},g));var g};k.prototype._renderLegendForElement=function(a,
d,b){var h=this,c="color-ramp"===a.type,e="opacity-ramp"===a.type,g="size-ramp"===a.type,k=null;if("symbol-table"===a.type||g){var l=a.infos.map(function(b){return h._renderLegendForElementInfo(b,d,g,a.legendType)}).filter(function(a){return!!a});l.length&&(k=f.tsx("div",{class:"esri-legend__layer-body"},l))}else if(c||e)k=this._renderLegendForRamp(a.infos,a.overlayColor,e);if(!k)return null;var l=a.title,n=null;"string"===typeof l?n=l:l&&(n=p.getTitle(l,c||e),n=p.isRendererTitle(l,c||e)&&l.title?
l.title+" ("+n+")":n);c=b?"esri-legend__layer-child-table":"esri-legend__layer-table";e=n?f.tsx("div",{class:"esri-legend__layer-caption"},n):null;b=(m={},m["esri-legend__layer-table--size-ramp"]=g||!b,m);return f.tsx("div",{class:c,classes:b},e,k);var m};k.prototype._renderLegendForRamp=function(a,d,b){var h=a.length-1,c=null;2<h?c=25*h:c=50;var e=document.createElement("div");e.className="esri-legend__color-ramp "+(b?"esri-legend__opacity-ramp":"");e.style.height=c+"px";b=v.createSurface(e,"100%",
c);try{a.forEach(function(a,b){a.offset=b/h}),b.createRect({x:0,y:0,width:"100%",height:c}).setFill({type:"linear",x1:0,y1:0,x2:0,y2:c,colors:a}).setStroke(null),d&&0<d.a&&b.createRect({x:0,y:0,width:"100%",height:c}).setFill(d).setStroke(null)}catch(g){b.clear(),b.destroy()}if(!b)return null;a=a.filter(function(a){return!!a.label}).map(function(a){return f.tsx("div",{class:"esri-legend__ramp-label"},a.label)});c={height:c+"px"};return f.tsx("div",{class:"esri-legend__layer-row"},f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",
styles:{width:"24px"}},f.tsx("div",{class:"esri-legend__ramps",bind:e,afterCreate:p.attachToNode})),f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},f.tsx("div",{class:"esri-legend__ramp-labels",styles:c},a)))};k.prototype._renderLegendForElementInfo=function(a,d,b,h){if(a.type)return this._renderLegendForElement(a,d,!0);var c=null;h=p.isImageryStretchedLegend(d,h);a.symbol&&a.preview?c=f.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:p.attachToNode}):
a.src&&(c=this._renderImage(a,d,h));if(!c)return null;d=(e={},e["esri-legend__imagery-layer-info--stretched"]=h,e);b=(g={},g["esri-legend__imagery-layer-info--stretched"]=h,g["esri-legend__size-ramp"]=!h&&b,g);return f.tsx("div",{class:"esri-legend__layer-row"},f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",classes:b},c),f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info",classes:d},a.label||""));var e,g};k.prototype._renderImage=function(a,d,
b){var h=a.label,c=a.src,e=a.opacity;b=(g={},g["esri-legend__imagery-layer-image--stretched"]=b,g["esri-legend__symbol"]=!b,g);return f.tsx("img",{alt:h,src:c,border:0,width:a.width,height:a.height,classes:b,styles:{opacity:""+(null!=e?e:d.opacity)}});var g};q([f.renderable(),m.property()],k.prototype,"activeLayerInfos",void 0);return k=q([m.subclass("esri.widgets.Legend.styles.Classic")],k)}(m.declared(w))});